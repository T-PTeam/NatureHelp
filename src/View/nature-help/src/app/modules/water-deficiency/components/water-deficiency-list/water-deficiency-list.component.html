<div class="header">
  <h2 i18n>Deficiencies (Water)</h2>
  <input
    type="search"
    placeholder="Search for deficiencies..."
    [(ngModel)]="search" />
  <button
    (click)="downloadExcel()"
    class="action-btn"
    id="export-btn">
    <i class="material-icons">insert_drive_file</i>
  </button>
  <button
    (click)="navigateToDetail()"
    class="action-btn"
    id="add-btn">
    <i class="material-icons">add</i>
  </button>
  <mat-slide-toggle
    style="transform: rotate(180deg)"
    [checked]="true"
    (change)="goToSoil()">
  </mat-slide-toggle>
</div>

<div class="grid-container">
  <div class="grid-header">
    <div i18n="@@dissolvedOxygen">Dissolved Oxygen</div>
    <div>pH</div>
    <div i18n="@@leadConcentration">Lead Concentration</div>
    <div i18n="@@nitrateConcentration">Nitrate Concentration</div>
    <div i18n="@@chemicalOxygenDemand">Chemical Ox. Demand</div>
    <div>Creator</div>
    <div>Responsible User</div>
    <div>Danger State</div>
    <div>Map</div>
    <div>Edit</div>
  </div>
  <div
    class="grid-body"
    infiniteScroll
    [infiniteScrollDistance]="2"
    [infiniteScrollThrottle]="500"
    [infiniteScrollDisabled]="scrollCheckDisabled"
    (scrolled)="onScroll()">
    <div
      *ngFor="let deficiency of waterAPIService.deficiencies$ | async"
      class="grid-row">
      <div>{{ deficiency.dissolvedOxygen || 0 }}</div>
      <div>{{ deficiency.ph || 0 }}</div>
      <div>{{ deficiency.leadConcentration || 0 }}</div>
      <div>{{ deficiency.nitratesConcentration || 0 }}</div>
      <div>{{ deficiency.chemicalOxygenDemand || 0 }}</div>
      <div>{{ deficiency.creator.firstName }} {{ deficiency.creator.lastName }}</div>
      <div>{{ deficiency.responsibleUser?.firstName }} {{ deficiency.responsibleUser?.lastName }}</div>
      <div>{{ deficiency.eDangerState | enumToString: "EDangerState" }}</div>
      <div>
        <button
          id="map-focus-btn"
          (click)="changeMapFocus(deficiency.location)"
          class="action-btn">
          <i class="fa fa-crosshairs"></i>
        </button>
      </div>
      <div>
        <button
          id="edit-btn"
          (click)="navigateToDetail(deficiency.id)"
          class="action-btn">
          <i class="fa fa-edit"></i>
        </button>
      </div>
    </div>
  </div>
</div>
